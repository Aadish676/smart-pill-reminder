<!DOCTYPE html>
<html>
<head>
    <title>Dashboard - Smart Pill Reminder</title>
</head>
<body>
    <h1>Welcome, {{ current_user.email }}</h1>
    <a href="{{ url_for('logout') }}">Logout</a>

    <h2>Add Family Member</h2>
    <form action="{{ url_for('add_member') }}" method="POST">
        <label>Name:</label><br>
        <input type="text" name="name" required><br><br>

        <label>Phone Number (with country code, e.g. +919999999999):</label><br>
        <input type="text" name="phone" required><br><br>

        <label>Notification Method:</label><br>
        <select name="notify_method" required>
            <option value="email">Email</option>
            <option value="sms">SMS</option>
            <option value="whatsapp">WhatsApp</option>
        </select><br><br>

        <button type="submit">Add Member</button>
    </form>

    <h2>Family Members & Pills</h2>
    {% for member in members %}
        <div style="border:1px solid #ccc; padding:10px; margin-bottom:10px;">
            <h3>{{ member.name }} ({{ member.notify_method }})</h3>
            <p>Phone: {{ member.phone }}</p>

            <h4>Assign Pill</h4>
            <form action="{{ url_for('assign_pill', member_id=member.id) }}" method="POST">
                <label>Pill Name:</label><br>
                <input type="text" name="pill_name" required><br><br>

                <label>Time (HH:MM - 24hr format):</label><br>
                <input type="time" name="pill_time" required><br><br>

                <button type="submit">Assign Pill</button>
            </form>

            <h4>Current Pills:</h4>
            <ul>
                {% for pill in member.pills %}
                    <li>{{ pill.name }} at {{ pill.time }} ({{ pill.status }})</li>
                {% else %}
                    <li>No pills assigned.</li>
                {% endfor %}
            </ul>
        </div>
    {% else %}
        <p>No family members added yet.</p>
    {% endfor %}
</body>
</html>

